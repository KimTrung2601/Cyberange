<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H∆∞·ªõng d·∫´n: T·∫•n c√¥ng ARP Spoofing & Ph√≤ng ch·ªëng</title>

    <link rel="stylesheet" href="css/dashboard.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* ƒê·ªãnh nghƒ©a bi·∫øn m√†u s·∫Øc */
        :root {
            --bg-dark: #0f1624;
            --bg-card: #1a2332; 
            --blue: #3fa9f5; 
            --text: #e6eef7; 
            --muted: #98a6b8;
            --orange: #f5b041; 
            --red: #e74c3c;
            --border-light: #2c3a4d;
        }
        
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: var(--bg-dark);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to  { opacity: 1; transform: translateY(0); }
        }

        .app {
            display: flex; 
            min-height: 100vh;
            background: var(--bg-dark);
        }
        
        .sidebar {
            background: #131b29;
            border-right: 1px solid #243044;
            min-width: 280px;
            padding: 24px 20px;
            position: sticky; 
            top: 0;           
            height: 100vh;    
            display: flex;
            flex-direction: column;
            overflow-y: hidden; 
        }

        .sidebar-nav {
            flex-grow: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: auto;
            margin-top: 8px;
        }
        
        .nav-item {
            padding: 10px 14px;
            color: var(--muted);
            text-decoration: none;
            font-size: 15px;
            border-radius: 6px;
            transition: 0.25s;
        }
        .nav-item:hover { background: #1f2a3b; color: white; }

        .main {
            flex-grow: 1;
            width: 100%;
        }
        
        .main-topbar {
            background: #10141a;
            padding: 15px 30px;
            border-bottom: 1px solid var(--border-light);
        }
        
        .guide-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 25px;
            color: var(--text);
            animation: fadeIn 0.4s ease;
        }
        
        h2 {
            margin-top: 35px;
            color: var(--blue);
            border-bottom: 2px solid var(--border-light);
            padding-bottom: 8px;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(63, 169, 245, 0.4);
        }
        
        h3 {
            margin-top: 25px;
            color: var(--text);
            font-size: 19px;
            font-weight: 700;
        }

        p, ul, ol {
            color: var(--muted);
            line-height: 1.7;
            font-size: 16px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        ul {
            list-style: disc;
            padding-left: 25px;
        }
        
        .video-embed {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            margin-top: 14px;
            margin-bottom: 30px;
            border: 2px solid var(--blue); 
            border-radius: 12px;
            background: #10141a;
            box-shadow: 0 0 15px rgba(0,0,0,0.5); 
        }

        .video-embed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .code-block {
            background: #131c27;
            padding: 12px 16px;
            border-left: 4px solid var(--orange);
            color: #f6d76c;
            font-family: Consolas, monospace;
            border-radius: 6px;
            margin: 14px 0;
            font-size: 15px;
            box-shadow: inset 0 0 6px rgba(0,0,0,0.4); 
        }

        .attack-step {
            background: var(--bg-card);
            border-left: 5px solid var(--red);
            padding: 20px;
            margin-top: 35px;
            margin-bottom: 40px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(231,76,60,0.3);
        }

        .guide-image-container {
            border: 1px solid var(--border-light);
            border-radius: 10px;
            overflow: hidden;
            margin: 25px 0;
            box-shadow: 0 0 10px rgba(0,0,0,0.4);
            transition: transform 0.2s ease;
        }
        .guide-image-container:hover {
            transform: scale(1.01);
        }
        .guide-image-container img {
            width: 100%;
            display: block;
        }
        .image-caption {
            padding: 10px;
            background: #1e2a38;
            color: #cfe1ff;
            font-size: 14px;
            font-style: italic;
            border-top: 1px solid #2e394b;
        }

        /* ------------------- Quiz Styles ------------------- */
        .quiz-container .question-block {
            margin-top: 35px;
        }
        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .quiz-input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid var(--border-light);
            background: #0f1624; 
            color: var(--text);
            border-radius: 4px;
            font-size: 15px;
        }
        .quiz-button {
            padding: 10px 20px;
            background: #27ae60; 
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        .quiz-button:hover {
            background: #2ecc71;
        }
    </style>

</head>

<body>
    <div class="app">

        <aside class="sidebar">
            <header class="sidebar-logo">
                <i class="fas fa-shield-alt"></i>
                <span>CYBER<br>RANGES</span>
            </header>

            <div class="sidebar-user">
                <strong>ƒêH C√¥ng Th∆∞∆°ng</strong>
                <small id="sidebar-username">My Account</small>
            </div>

            <nav class="sidebar-nav">
                <a href="#" onclick="history.back(); return false;" class="nav-item active">
                    <i class="fas fa-arrow-left"></i> Back to Playlists
                </a>
                <h3 style="color:var(--text); margin-top:20px; padding:0 14px; font-size:16px;">M·ª•c l·ª•c</h3>
                <a href="#tong-quan" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">1. T·ªïng quan</a>
                <a href="#cau-hinh-ban-dau" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">I. C·∫•u h√¨nh ban ƒë·∫ßu</a>
                <a href="#thuc-hien-tan-cong" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">II. Th·ª±c hi·ªán t·∫•n c√¥ng</a>
                <a href="#kiem-tra-ket-qua" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">III. Ki·ªÉm tra k·∫øt qu·∫£</a>
                <a href="#phong-chong" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">IV. Ph√≤ng ch·ªëng & DAI</a>
                <a href="#quiz" class="nav-item" style="font-size:14px; color:var(--muted); font-weight:400;">V. Quiz</a>
            </nav>
        </aside>

        <main class="main">
            <header class="main-topbar">
                <h1 style="color:#fff; margin:0; font-size:28px;"><i class="fas fa-satellite-dish" style="color:var(--red); margin-right:10px;"></i> H∆∞·ªõng d·∫´n: T·∫•n c√¥ng ARP Spoofing & Ph√≤ng ch·ªëng</h1>
            </header>

            <section class="guide-container">

                <h2 id="tong-quan">üìñ 1. T·ªïng quan k·ªãch b·∫£n</h2>
                <p>
                    K·ªãch b·∫£n m√¥ ph·ªèng t·∫•n c√¥ng **ARP Spoofing** v√† c∆° ch·∫ø ph√≤ng ch·ªëng (DHCP Snooping, Dynamic ARP Inspection) trong m√¥ h√¨nh m·∫°ng g·ªìm c√°c th√†nh ph·∫ßn:
                </p>
                <div class="video-embed">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/snRzr5eN3ek?si=Goqh53s93OfG6QLj" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>

                
                <ul>
                    <li>**M√°y t·∫•n c√¥ng (Kali Linux):** Nghe l√©n Telnet.</li>
                    <li>**M√°y n·∫°n nh√¢n (Windows 10):** Th·ª±c hi·ªán Telnet ƒë·∫øn Router.</li>
                    <li>**Router & Switch:** Switch ƒë√≥ng vai tr√≤ DHCP Server, ƒë·ªìng th·ªùi ƒë∆∞·ª£c c·∫•u h√¨nh **DHCP Snooping** v√† **Dynamic ARP Inspection (DAI)** cho m·ª•c ƒë√≠ch ph√≤ng ch·ªëng.</li>
                </ul>

                <div class="guide-image-container">
                    <img src="images/hinh57.jpg" alt="M√¥ h√¨nh b√†i th·ª±c h√†nh ARP Spoofing g·ªìm Router, Switch, Windows 10, v√† Kali Linux">
                    <div class="image-caption">H√¨nh 57. M√¥ h√¨nh th·ª±c hi·ªán demo</div>
                </div>

                <hr style="border-top: 1px solid var(--border-light); margin: 30px 0;">

                <h2 id="cau-hinh-ban-dau">I. C·∫•u h√¨nh ban ƒë·∫ßu & Thu th·∫≠p th√¥ng tin</h2>

                <h3><i class="fas fa-info-circle" style="color:var(--blue); margin-right:8px;"></i> T√≥m t·∫Øt Th√¥ng s·ªë M·∫°ng</h3>
                <p>C√°c thi·∫øt b·ªã nh·∫≠n th√¥ng s·ªë t·ª´ DHCP (Switch) nh∆∞ sau:</p>
                <div style="background: var(--bg-card); padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <p style="color:var(--orange); font-weight: bold;">Router (Gateway):</p>
                    <ul>
                        <li>IP: **192.168.1.1/24**</li>
                        <li>MAC: **CA:01:05:C8:00:00**</li>
                    </ul>
                    <p style="color:var(--orange); font-weight: bold;">Windows 10 (N·∫°n nh√¢n):</p>
                    <ul>
                        <li>IP: **192.168.1.6/24**</li>
                        <li>MAC: **00:0C:29:61:A8:10**</li>
                    </ul>
                    <p style="color:var(--orange); font-weight: bold;">Kali Linux (T·∫•n c√¥ng):</p>
                    <ul>
                        <li>IP: **192.168.1.7/24**</li>
                        <li>MAC: **00:0C:29:5B:CC:F0**</li>
                    </ul>
                </div>
                
                <p>Ki·ªÉm tra IP v√† c·∫•u h√¨nh DHCP tr√™n Router (192.168.1.1):</p>
                <div class="guide-image-container">
                    <img src="images/hinh58.jpg" alt="IP Router">
                    <div class="image-caption">H√¨nh 58. IP router</div>
                </div>
                <div class="guide-image-container">
                    <img src="images/hinh59.jpg" alt="Th√¥ng tin c·∫•u h√¨nh DHCP tr√™n router">
                    <div class="image-caption">H√¨nh 59. Th√¥ng tin c·∫•u h√¨nh dhcp tr√™n router</div>
                </div>

                <h3><i class="fas fa-table" style="color:var(--blue); margin-right:8px;"></i> Ki·ªÉm tra ARP Cache Table ban ƒë·∫ßu</h3>
                <p>Tr√™n m√°y Kali Linux, khi nh·∫≠n ƒë∆∞·ª£c IP DHCP l√† **192.168.1.7** v·ªõi ƒë·ªãa ch·ªâ MAC l√† **00:0C:29:5B:CC:F0**.</p>
                <div class="guide-image-container">
                    <img src="images/hinh60.jpg" alt="IP v√† MAC tr√™n m√°y t·∫•n c√¥ng (Kali Linux)">
                    <div class="image-caption">H√¨nh 60. IP v√† MAC tr√™n m√°y t·∫•n c√¥ng (Kali Linux)</div>
                </div>
                <p>Tr√™n m√°y Windows 10 s·∫Ω nh·∫≠n IP l√† **192.168.1.6** v·ªõi MAC l√† **00:0C:29:61:A8:10**.</p>
                <div class="guide-image-container">
                    <img src="images/hinh61.jpg" alt="IP v√† MAC tr√™n m√°y n·∫°n nh√¢n (Windows 10)">
                    <div class="image-caption">H√¨nh 61. IP v√† MAC tr√™n m√°y n·∫°n nh√¢n (Windows 10)</div>
                </div>

                <p>Ki·ªÉm tra ARP Cache Table tr√™n Windows, c√≥ 192.168.1.1 l√† IP c·ªßa Router, 192.168.1.7 l√† IP c·ªßa m√°y Kali Linux, l√∫c ch∆∞a b·ªã t·∫•n c√¥ng th√¨ ta v·∫´n th·∫•y ƒë·ªãa ch·ªâ MAC c·ªßa Router v√† Kali Linux v·∫´n kh√°c nhau.</p>
                <div class="guide-image-container">
                    <img src="images/hinh62.jpg" alt="B·∫£ng arp tr√™n m√°y n·∫°n nh√¢n (Windows 10) ban ƒë·∫ßu">
                    <div class="image-caption">H√¨nh 62. B·∫£ng arp tr√™n m√°y n·∫°n nh√¢n (Windows 10) ban ƒë·∫ßu</div>
                </div>
                <p>T∆∞∆°ng t·ª± ARP Cache Table tr√™n Kali Linux th·∫•y 192.168.1.1 l√† IP c·ªßa Router, 192.168.1.6 l√† IP c·ªßa m√°y Windows 10.</p>
                <div class="guide-image-container">
                    <img src="images/hinh63.jpg" alt="B·∫£ng arp tr√™n m√°y t·∫•n c√¥ng (Kali Linux)">
                    <div class="image-caption">H√¨nh 63. B·∫£ng arp tr√™n m√°y t·∫•n c√¥ng (Kali Linux)</div>
                </div>

                ---

                <h2 id="thuc-hien-tan-cong">II. Th·ª±c hi·ªán t·∫•n c√¥ng ARP Spoofing</h2>
                
                <div class="attack-step">
                    <h3><i class="fas fa-toggle-on" style="color:var(--red); margin-right:8px;"></i> B∆∞·ªõc 1: K√≠ch ho·∫°t IP Forwarding</h3>
                    <p>S·ª≠ d·ª•ng c√¢u l·ªánh nh∆∞ h√¨nh ƒë·ªÉ c√≥ th·ªÉ chuy·ªÉn ti·∫øp g√≥i tin, bi·∫øn m√°y Kali Linux th√†nh m·ªôt tr·∫°m trung chuy·ªÉn, chuy·ªÉn ti·∫øp g√≥i tin gi·ªØa Router v√† n·∫°n nh√¢n (Windows 10).</p>
                    <div class="code-block">echo 1 > /proc/sys/net/ipv4/ip_forward</div>
                    <div class="guide-image-container">
                        <img src="images/hinh64.jpg" alt="L·ªánh ƒë·ªÉ chuy·ªÉn ti·∫øp d·ªØ li·ªáu v·ªÅ l·∫°i m√°y n·∫°n nh√¢n">
                        <div class="image-caption">H√¨nh 64. L·ªánh ƒë·ªÉ chuy·ªÉn ti·∫øp d·ªØ li·ªáu v·ªÅ l·∫°i m√°y n·∫°n nh√¢n</div>
                    </div>
                </div>

                <div class="attack-step">
                    <h3><i class="fas fa-search" style="color:var(--red); margin-right:8px;"></i> B∆∞·ªõc 2: Qu√©t host v√† x√°c ƒë·ªãnh m·ª•c ti√™u</h3>
                    <p>S·ª≠ d·ª•ng c√¥ng c·ª• **Nmap** ƒë·ªÉ qu√©t c√°c host c√≤n ho·∫°t ƒë·ªông trong m·∫°ng LAN 192.168.1.0/24 ƒë·ªÉ t√¨m ra c√°c ƒë·ªëi t∆∞·ª£ng. Sau khi qu√©t xong ta th·∫•y **192.168.1.1** l√† Router m·ª•c ti√™u, v√† **192.168.1.6** l√† n·∫°n nh√¢n. Trong demo n√†y, nh√≥m ti·∫øn h√†nh t·∫•n c√¥ng b·∫±ng c√°ch chen gi·ªØa v√†o Router (192.168.1.1) v√† N·∫°n nh√¢n (192.168.1.6).</p>
                    <div class="guide-image-container">
                        <img src="images/hinh65.jpg" alt="D√πng Nmap ƒë·ªÉ qu√©t c√°c host trong m·∫°ng">
                        <div class="image-caption">H√¨nh 65. D√πng Nmap ƒë·ªÉ qu√©t c√°c host trong m·∫°ng</div>
                    </div>
                </div>

                <div class="attack-step">
                    <h3><i class="fas fa-mask" style="color:var(--red); margin-right:8px;"></i> B∆∞·ªõc 3: Th·ª±c hi·ªán ƒê·∫ßu ƒë·ªôc ARP b·∫±ng ArpSpoof</h3>
                    <p>Sau khi x√°c ƒë·ªãnh ƒë∆∞·ª£c m·ª•c ti√™u ƒë·ªÉ t·∫•n c√¥ng, ta s·ª≠ d·ª•ng c√¥ng c·ª• **ArpSpoof** ƒë·ªÉ t·∫•n c√¥ng v·ªõi mode `-i` ƒë·ªÉ ch·ªâ ƒë·ªãnh card m·∫°ng, `-t` ch·ªâ ƒë·ªãnh IP target/n·∫°n nh√¢n, v√† `-r` ƒë·ªÉ ch·ªâ ƒë·ªãnh IP router.</p>
                    <p>Khi ch·∫°y, ta c√≥ th·ªÉ th·∫•y c√°c g√≥i tin ARP Reply ƒë∆∞·ª£c g·ª≠i ƒë·∫øn n·∫°n nh√¢n b·∫£o r·∫±ng ƒë·ªãa ch·ªâ **192.168.1.1 (IP router)** c√≥ MAC l√† **00:0C:29:5B:CC:F0 (MAC c·ªßa m√°y t·∫•n c√¥ng)** v√† g·ª≠i ƒë·∫øn router b·∫£o r·∫±ng ƒë·ªãa ch·ªâ **192.168.1.6 (IP c·ªßa n·∫°n nh√¢n)** c≈©ng c√≥ ƒë·ªãa ch·ªâ MAC l√† **MAC c·ªßa m√°y t·∫•n c√¥ng**.</p>
                    <div class="guide-image-container">
                        <img src="images/hinh66.jpg" alt="D√πng ArpSpoof ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng">
                        <div class="image-caption">H√¨nh 66. D√πng ArpSpoof ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng</div>
                    </div>
                </div>

                ---

                <h2 id="kiem-tra-ket-qua">III. Ki·ªÉm tra k·∫øt qu·∫£ & Nghe l√©n</h2>

                <div class="attack-step" style="border-left: 5px solid var(--orange);">
                    <h3><i class="fas fa-check-circle" style="color:var(--orange); margin-right:8px;"></i> Ki·ªÉm tra B·∫£ng ARP sau t·∫•n c√¥ng</h3>
                    <p>Ti·∫øn h√†nh ki·ªÉm tra ARP Cache Table tr√™n m√°y Windows 10 (N·∫°n nh√¢n) b·∫±ng l·ªánh `arp -a`. Ta c√≥ th·ªÉ th·∫•y ƒë·ªãa ch·ªâ **192.168.1.1 (router)** v√† **192.168.1.7 (m√°y t·∫•n c√¥ng)** b·ªã tr√πng ƒë·ªãa ch·ªâ MAC (MAC c·ªßa Kali Linux).</p>
                    <p style="color:var(--red); font-weight: 600;">L√∫c n√†y nghƒ©a l√† m√°y n·∫°n nh√¢n ƒë√£ b·ªã **ƒë·∫ßu ƒë·ªôc ARP**.</p>
                    <p>Khi ƒë√£ b·ªã ƒë·∫ßu ƒë·ªôc, n·∫°n nh√¢n **kh√¥ng th·ªÉ telnet ƒë∆∞·ª£c t·ªõi router** do g√≥i tin ƒë√£ b·ªã chuy·ªÉn h∆∞·ªõng v√† c√≥ th·ªÉ b·ªã ch·∫∑n/chuy·ªÉn ti·∫øp b·ªüi m√°y t·∫•n c√¥ng.</p>
                    <div class="guide-image-container">
                        <img src="images/hinh67.jpg" alt="B·∫£ng arp c·ªßa m√°y n·∫°n nh√¢n (Windows 10) khi b·ªã t·∫•n c√¥ng">
                        <div class="image-caption">H√¨nh 67. B·∫£ng arp c·ªßa m√°y n·∫°n nh√¢n (Windows 10) khi b·ªã t·∫•n c√¥ng</div>
                    </div>
                </div>
                
                <div class="attack-step" style="border-left: 5px solid var(--orange);">
                    <h3><i class="fas fa-eye" style="color:var(--orange); margin-right:8px;"></i> Nghe l√©n N·ªôi dung Telnet</h3>
                    <p>S·ª≠ d·ª•ng c√¥ng c·ª• ph√¢n t√≠ch g√≥i tin m·∫°ng (v√≠ d·ª•: **Wireshark**) tr√™n m√°y Kali Linux. Y√™u c·∫ßu N·∫°n nh√¢n th·ª±c hi·ªán k·∫øt n·ªëi **Telnet** ƒë·∫øn Router. Do Telnet l√† giao th·ª©c kh√¥ng m√£ h√≥a, Kali c√≥ th·ªÉ thu th·∫≠p v√† tr√≠ch xu·∫•t th√¥ng tin ƒëƒÉng nh·∫≠p v√† m·∫≠t kh·∫©u t·ª´ l∆∞u l∆∞·ª£ng m·∫°ng ƒëi qua n√≥.</p>
                </div>
                
                ---
                
                <h2 id="phong-chong">IV. C∆° ch·∫ø Ph√≤ng ch·ªëng (DHCP Snooping & DAI)</h2>

                <div class="attack-step" style="border-left: 5px solid var(--blue);">
                    <h3><i class="fas fa-shield-alt" style="color:var(--blue); margin-right:8px;"></i> C∆° ch·∫ø Ph√≤ng ch·ªëng</h3>
                    <p>Trong m√¥ h√¨nh n√†y, **Switch** ƒë∆∞·ª£c c·∫•u h√¨nh hai c∆° ch·∫ø b·∫£o m·∫≠t li√™n quan ƒë·∫øn ARP:</p>
                    <ul>
                        <li>**DHCP Snooping:** Theo d√µi v√† x√°c th·ª±c c√°c g√≥i tin DHCP. N√≥ x√¢y d·ª±ng **Binding Table** (b·∫£ng √°nh x·∫° IP-MAC-Port-VLAN) d·ª±a tr√™n c√°c g√≥i DHCP Reply h·ª£p l·ªá. B·∫£ng n√†y l√† c∆° s·ªü d·ªØ li·ªáu ƒë√°ng tin c·∫≠y.</li>
                        <li>**Dynamic ARP Inspection (DAI):** Ki·ªÉm tra c√°c g√≥i tin ARP (c·∫£ Request v√† Reply) g·ª≠i ƒë·∫øn. DAI s·∫Ω so s√°nh th√¥ng tin IP/MAC/Port trong g√≥i ARP v·ªõi **Binding Table** c·ªßa DHCP Snooping.</li>
                    </ul>
                    <p>Khi k·∫ª t·∫•n c√¥ng g·ª≠i g√≥i tin ARP gi·∫£ m·∫°o, **DAI** s·∫Ω ki·ªÉm tra MAC Address gi·∫£ m·∫°o v√† **ch·∫∑n** g√≥i tin ƒë√≥ n·∫øu n√≥ kh√¥ng kh·ªõp v·ªõi th√¥ng tin ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n trong Binding Table (MAC th·∫≠t c·ªßa Router ho·∫∑c N·∫°n nh√¢n). Nh·ªù ƒë√≥, cu·ªôc t·∫•n c√¥ng ARP Spoofing b·ªã v√¥ hi·ªáu h√≥a.</p>

                    <div class="guide-image-container">
                        <img src="images/hinh68.jpg" alt="B·∫£ng √°nh x·∫° IP-MAC c·ªßa DHCP Snooping">
                        <div class="image-caption">H√¨nh 68. B·∫£ng √°nh x·∫° IP-MAC c·ªßa DHCP Snooping</div>
                    </div>
                </div>

                ---
                
                <h2 id="quiz">üìù V. Quiz ki·ªÉm tra ki·∫øn th·ª©c</h2>

                <div class="quiz-container" style="background: var(--bg-card); padding: 30px; border-radius: 10px; margin-top: 25px; border: 1px solid var(--border-light);">
                    
                    <div id="completion-message" style="display: none; padding: 20px; background: #2ecc71; color: white; border-radius: 8px; text-align: center; font-size: 18px; font-weight: 700;">
                        <i class="fas fa-check-circle"></i> CH√öC M·ª™NG! B·∫†N ƒê√É HO√ÄN TH√ÄNH B√ÄI LAB TH√ÄNH C√îNG!
                    </div>

                    <div id="question-1" class="question-block">
                        <h3>1. T·∫•n c√¥ng ARP Spoofing</h3>
                        <p>ƒê·ªãa ch·ªâ MAC c·ªßa thi·∫øt b·ªã n√†o ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ƒë·∫ßu ƒë·ªôc c·∫£ Router v√† N·∫°n nh√¢n?</p>
                        <div class="input-group">
                            <input type="text" id="answer-1" class="quiz-input" placeholder="Nh·∫≠p MAC ho·∫∑c t√™n m√°y...">
                            <button class="quiz-button" onclick="checkAnswer(1)">Check</button>
                        </div>
                        <p id="feedback-1" style="margin-top: 10px; color: #e74c3c; font-weight: 600;"></p>
                    </div>

                    <div id="question-2" class="question-block" style="display:none;">
                        <h3>2. M·ª•c ti√™u ch√≠nh</h3>
                        <p>M·ª•c ti√™u ch√≠nh c·ªßa cu·ªôc t·∫•n c√¥ng ARP Spoofing ƒë·ªÉ nghe l√©n l√† g√¨? (Nh·∫≠p t√™n k·ªπ thu·∫≠t 4 t·ª´)</p>
                        <div class="input-group">
                            <input type="text" id="answer-2" class="quiz-input" placeholder="Nh·∫≠p t√™n k·ªπ thu·∫≠t...">
                            <button class="quiz-button" onclick="checkAnswer(2)">Check</button>
                        </div>
                        <p id="feedback-2" style="margin-top: 10px; color: #e74c3c; font-weight: 600;"></p>
                    </div>

                    <div id="question-3" class="question-block" style="display:none;">
                        <h3>3. IP Forwarding</h3>
                        <p>L·ªánh `echo 1 > /proc/sys/net/ipv4/ip_forward` d√πng ƒë·ªÉ l√†m g√¨?</p>
                        <div class="input-group">
                            <input type="text" id="answer-3" class="quiz-input" placeholder="Nh·∫≠p ch·ª©c nƒÉng...">
                            <button class="quiz-button" onclick="checkAnswer(3)">Check</button>
                        </div>
                        <p id="feedback-3" style="margin-top: 10px; color: #e74c3c; font-weight: 600;"></p>
                    </div>

                    <div id="question-4" class="question-block" style="display:none;">
                        <h3>4. C∆° ch·∫ø Ph√≤ng ch·ªëng</h3>
                        <p>T√≠nh nƒÉng n√†o tr√™n Switch ki·ªÉm tra g√≥i tin ARP b·∫±ng c√°ch so s√°nh v·ªõi Binding Table?</p>
                        <div class="input-group">
                            <input type="text" id="answer-4" class="quiz-input" placeholder="Nh·∫≠p t√™n c∆° ch·∫ø (vi·∫øt t·∫Øt ho·∫∑c ƒë·∫ßy ƒë·ªß)...">
                            <button class="quiz-button" onclick="checkAnswer(4)">Check</button>
                        </div>
                        <p id="feedback-4" style="margin-top: 10px; color: #e74c3c; font-weight: 600;"></p>
                    </div>

                    <div id="question-5" class="question-block" style="display:none;">
                        <h3>5. C∆° s·ªü d·ªØ li·ªáu</h3>
                        <p>Binding Table ƒë∆∞·ª£c x√¢y d·ª±ng b·ªüi t√≠nh nƒÉng b·∫£o m·∫≠t n√†o tr√™n Switch?</p>
                        <div class="input-group">
                            <input type="text" id="answer-5" class="quiz-input" placeholder="Nh·∫≠p t√™n c∆° ch·∫ø (vi·∫øt t·∫Øt ho·∫∑c ƒë·∫ßy ƒë·ªß)...">
                            <button class="quiz-button" onclick="checkAnswer(5)">Check</button>
                        </div>
                        <p id="feedback-5" style="margin-top: 10px; color: #e74c3c; font-weight: 600;"></p>
                    </div>

                </div>
                <div style="margin-top: 50px; border-top: 1px solid var(--border-light); padding-top: 20px; font-size: 14px; text-align: center; color: var(--muted);">
                    &copy; 2025 Cyber Ranges Platform. All rights reserved.
                </div>

            </section>
        </main>
    </div>

    <script>
        // 1. C·∫§U H√åNH ƒê√ÅP √ÅN
        const correctAnswers = {
            1: ["00:0c:29:5b:cc:f0", "mac c·ªßa kali", "kali linux", "m√°y t·∫•n c√¥ng", "attacker"],
            2: ["man-in-the-middle", "man in the middle", "nghe l√©n"],
            3: ["chuy·ªÉn ti·∫øp g√≥i tin", "ip forwarding", "tr·∫°m trung chuy·ªÉn", "forwarding"],
            4: ["dynamic arp inspection", "dai", "dai inspection"],
            5: ["dhcp snooping", "dhcp snooping"]
        };
    
        // --- H√ÄM G·ª¨I TI·∫æN ƒê·ªò (NH·∫¨N S·ªê PH·∫¶N TRƒÇM) ---
        async function submitProgress(percent) {
            const username = localStorage.getItem("cyber_current_user");
            
            if (!username) {
                console.log("Ch∆∞a ƒëƒÉng nh·∫≠p, kh√¥ng l∆∞u ƒë∆∞·ª£c.");
                return;
            }
    
            try {
                console.log(`ƒêang g·ª≠i ti·∫øn ƒë·ªô ${percent}% v·ªÅ Server...`);
                
                // G·ª≠i s·ªë % c·ª• th·ªÉ v·ªÅ Server
                const response = await fetch('/api/submit-quiz', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        username: username, 
                        labId: 'arp_spoofing', 
                        progress: percent 
                    })
                });
    
                const data = await response.json();
                console.log("Server ƒë√£ l∆∞u:", data);
    
            } catch (error) {
                console.error("L·ªói k·∫øt n·ªëi Server:", error);
            }
        }
    
        // 2. H√ÄM CHU·∫®N H√ìA ƒê√ÅP √ÅN
        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ");
        }
    
        // 3. H√ÄM CHECK ƒê√ÅP √ÅN (ƒê√É S·ª¨A ƒê·ªÇ G·ª¨I ƒêI·ªÇM T·ª™NG C√ÇU)
        function checkAnswer(questionNumber) {
            const inputId = 'answer-' + questionNumber;
            const feedbackId = 'feedback-' + questionNumber;
            const currentQuestionId = 'question-' + questionNumber;
            
            const userInput = document.getElementById(inputId).value;
            const feedbackElement = document.getElementById(feedbackId);
            const currentQuestionElement = document.getElementById(currentQuestionId);
            
            const normalizedInput = normalizeAnswer(userInput);
            const validAnswers = correctAnswers[questionNumber];
            let isCorrect = false;
    
            for (const valid of validAnswers) {
                if (normalizedInput.includes(normalizeAnswer(valid))) {
                    isCorrect = true;
                    break;
                }
            }
    
            if (isCorrect) {
                // --- X·ª¨ L√ù KHI ƒê√öNG ---
                feedbackElement.style.color = '#2ecc71';
                feedbackElement.innerHTML = '<i class="fas fa-check"></i> Ch√≠nh x√°c!';
                
                // Kh√≥a n√∫t l·∫°i
                document.getElementById(inputId).disabled = true;
                currentQuestionElement.querySelector('.quiz-button').disabled = true;
    
                // üëâ T√çNH TO√ÅN V√Ä G·ª¨I ƒêI·ªÇM NGAY L·∫¨P T·ª®C üëà
                // C√¢u 1 ƒë√∫ng -> 20%, C√¢u 2 ƒë√∫ng -> 40%...
                const currentPercent = questionNumber * 20;
                submitProgress(currentPercent); 
    
                
                // Chuy·ªÉn c√¢u h·ªèi sau 0.5 gi√¢y
                setTimeout(() => {
                    currentQuestionElement.style.display = 'none';
    
                    if (questionNumber < 5) {
                        // Hi·ªán c√¢u ti·∫øp theo
                        const nextQuestionId = 'question-' + (questionNumber + 1);
                        const nextQuestionElement = document.getElementById(nextQuestionId);
                        if (nextQuestionElement) {
                            nextQuestionElement.style.display = 'block';
                            document.getElementById('feedback-' + (questionNumber + 1)).innerHTML = '';
                        }
                    } else {
                        // N·∫øu l√† c√¢u cu·ªëi c√πng (C√¢u 5)
                        document.getElementById('completion-message').style.display = 'block';
                        document.getElementById('quiz').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, 500);
    
            } else {
                // --- X·ª¨ L√ù KHI SAI ---
                feedbackElement.style.color = '#e74c3c';
                feedbackElement.innerHTML = '<i class="fas fa-times"></i> Ch∆∞a ch√≠nh x√°c. Vui l√≤ng th·ª≠ l·∫°i!';
            }
        }
    
        // 4. KH·ªûI T·∫†O
        document.addEventListener('DOMContentLoaded', () => {
            const allQuestions = document.querySelectorAll('.question-block');
            allQuestions.forEach(q => { q.style.display = 'none'; });
            const firstQuestion = document.getElementById('question-1');
            if (firstQuestion) { firstQuestion.style.display = 'block'; }
        });
    </script>

</body>
</html>