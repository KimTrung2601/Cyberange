<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H∆∞·ªõng d·∫´n: DHCP Starvation & Rogue DHCP Server</title>

    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        :root {
            --bg-dark: #0f1624;
            --bg-card: #1a2332; 
            --blue: #3fa9f5; 
            --text: #e6eef7; 
            --muted: #98a6b8;
            --orange: #f5b041; 
            --red: #e74c3c;
            --border-light: #2c3a4d;
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg-dark);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .app {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            background: #131b29;
            border-right: 1px solid #243044;
            min-width: 280px;
            padding: 24px 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: hidden;
        }

        .sidebar-nav {
            flex-grow: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 8px;
        }

        /* üî• S·ª¨A L·∫†I STYLE CHO NAV-ITEM NH∆Ø FORM G·ªêC */
        .nav-item {
            padding: 10px 14px;
            color: var(--muted);
            text-decoration: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 400;
            transition: background 0.25s, color 0.25s;
        }

        .nav-item:hover {
            background: #1f2a3b;
            color: white;
        }

        .main {
            flex-grow: 1;
            width: 100%;
        }

        .main-topbar {
            background: #10141a;
            padding: 15px 30px;
            border-bottom: 1px solid var(--border-light);
        }

        .guide-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 25px;
            color: var(--text);
            animation: fadeIn 0.4s ease;
        }

        h2 {
            margin-top: 35px;
            color: var(--blue);
            border-bottom: 2px solid var(--border-light);
            padding-bottom: 8px;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(63, 169, 245, 0.4);
        }

        h3 {
            margin-top: 25px;
            color: var(--text);
            font-size: 19px;
            font-weight: 700;
        }

        p, ul, ol {
            color: var(--muted);
            line-height: 1.7;
            font-size: 16px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        ul { padding-left: 25px; }

        .video-embed {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            margin-top: 14px;
            margin-bottom: 30px;
            border: 2px solid var(--blue);
            border-radius: 12px;
            background: #10141a;
        }

        .video-embed iframe {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
        }

        .guide-image-container {
            border: 1px solid var(--border-light);
            border-radius: 10px;
            overflow: hidden;
            margin: 25px 0;
        }

        .guide-image-container img {
            width: 100%;
            display: block;
        }

        .image-caption {
            padding: 10px;
            background: #1e2a38;
            color: #cfe1ff;
            font-size: 14px;
            font-style: italic;
            border-top: 1px solid #2e394b;
        }

        .attack-step {
            background: var(--bg-card);
            border-left: 5px solid var(--red);
            padding: 20px;
            margin-top: 35px;
            margin-bottom: 40px;
            border-radius: 8px;
        }

        .quiz-input {
            padding: 10px;
            border: 1px solid var(--border-light);
            width: 80%;
            background: #0f1624;
            color: var(--text);
        }

        .quiz-button {
            padding: 10px 20px;
            background: #27ae60;
            border: none;
            color: white;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="app">

        <!-- ============================= -->
        <!-- SIDEBAR -->
        <!-- ============================= -->
        <aside class="sidebar">
            <header class="sidebar-logo">
                <i class="fas fa-shield-alt"></i>
                <span>CYBER<br>RANGES</span>
            </header>

            <div class="sidebar-user">
                <strong>ƒêH C√¥ng Th∆∞∆°ng</strong>
                <small id="sidebar-username">My Account</small>
            </div>

            <nav class="sidebar-nav">

                <a href="#" onclick="history.back(); return false;" class="nav-item active">
                    <i class="fas fa-arrow-left"></i> Back to Playlists
                </a>

                <h3 style="color:var(--text); margin-top:20px;">M·ª•c l·ª•c</h3>

                <!-- ‚≠ê ƒê√É TH√äM class="nav-item" -->
                <a href="#tong-quan" class="nav-item">1. T·ªïng quan</a>
                <a href="#starvation" class="nav-item">I. DHCP Starvation</a>
                <a href="#rogue" class="nav-item">II. Rogue DHCP Server</a>
                <a href="#quiz" class="nav-item">III. Quiz</a>
            </nav>
        </aside>

        <!-- ============================= -->
        <!-- MAIN CONTENT -->
        <!-- ============================= -->

        <main class="main">
            <header class="main-topbar">
                <h1 style="color:white;"><i class="fas fa-wifi" style="color:var(--red);"></i> DHCP Starvation & Rogue DHCP Server</h1>
            </header>

            <section class="guide-container">

                <!-- =============================== -->
                <!-- 1. T·ªîNG QUAN -->
                <!-- =============================== -->

                <h2 id="tong-quan">üìò 1. T·ªïng quan k·ªãch b·∫£n</h2>

                <p>
                    Trong b√†i lab n√†y, b·∫°n s·∫Ω th·ª±c h√†nh hai k·ªπ thu·∫≠t t·∫•n c√¥ng quan tr·ªçng li√™n quan ƒë·∫øn d·ªãch v·ª• DHCP:
                </p>

                <ul>
                    <li><strong>DHCP Starvation</strong> ‚Äì K·∫ª t·∫•n c√¥ng g·ª≠i h√†ng lo·∫°t y√™u c·∫ßu DHCP v·ªõi MAC gi·∫£ m·∫°o ƒë·ªÉ l√†m c·∫°n ki·ªát IP trong DHCP Scope.</li>
                    <li><strong>Rogue DHCP Server</strong> ‚Äì Sau khi DHCP th·∫≠t b·ªã v√¥ hi·ªáu h√≥a, k·∫ª t·∫•n c√¥ng d·ª±ng m·ªôt DHCP gi·∫£ m·∫°o ƒë·ªÉ c·∫•p IP sai cho Client.</li>
                </ul>

                <div class="video-embed">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/wkkoExSamUo?si=NAlrT8cyEunU9Faa" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>

                <!-- =============================== -->
                <!-- 2. DHCP STARVATION -->
                <!-- =============================== -->

                <h2 id="starvation">I. T·∫•n c√¥ng DHCP Starvation</h2>

                <h3>1. C√†i ƒë·∫∑t DHCP Server tr√™n Windows Server 2019</h3>

                <div class="guide-image-container">
                    <img src="images/hinh21.jpg">
                    <div class="image-caption">H√¨nh 4.1 ‚Äì ƒê·∫∑t IP tƒ©nh cho Windows Server</div>
                </div>

                <p>Server ƒë∆∞·ª£c ƒë·∫∑t IP tƒ©nh:</p>
                <ul>
                    <li>IP: 192.168.2.10</li>
                    <li>Subnet Mask: 255.255.255.0</li>
                </ul>

                <div class="guide-image-container">
                    <img src="images/hinh22.jpg">
                    <div class="image-caption">H√¨nh 4.2 ‚Äì T·∫°o Scope DHCP</div>
                </div>

                <div class="guide-image-container">
                    <img src="images/hinh23.jpg">
                    <div class="image-caption">H√¨nh 4.3 ‚Äì D·∫£i IP cho DHCP Scope</div>
                </div>

                <div class="guide-image-container">
                    <img src="images/hinh24.jpg">
                    <div class="image-caption">H√¨nh 4.4 ‚Äì K√≠ch ho·∫°t Scope</div>
                </div>

                <h3>2. B·∫Øt ƒë·∫ßu t·∫•n c√¥ng DHCP Starvation</h3>

                <div class="attack-step">
                    <h3>B∆∞·ªõc 1: M·ªü Yersinia</h3>
                    <div class="guide-image-container">
                        <img src="images/hinh25.jpg">
                        <div class="image-caption">H√¨nh 4.5 ‚Äì Giao di·ªán Yersinia</div>
                    </div>
                </div>

                <div class="attack-step">
                    <h3>B∆∞·ªõc 2: Xem danh s√°ch l·ªánh</h3>
                    <div class="guide-image-container">
                        <img src="images/hinh26.jpg">
                        <div class="image-caption">H√¨nh 4.6 ‚Äì C√°c l·ªánh Yersinia</div>
                    </div>
                </div>

                <div class="attack-step">
                    <h3>B∆∞·ªõc 3: B·∫≠t Interface</h3>
                    <div class="guide-image-container">
                        <img src="images/hinh27.jpg">
                        <div class="image-caption">H√¨nh 4.7 ‚Äì Interface eth0 ƒë∆∞·ª£c b·∫≠t</div>
                    </div>
                </div>

                <div class="attack-step">
                    <h3>B∆∞·ªõc 4: Th·ª±c hi·ªán DHCP Flood</h3>

                    <div class="guide-image-container">
                        <img src="images/hinh28.jpg">
                        <div class="image-caption">H√¨nh 4.8 ‚Äì G·ª≠i l·ªánh t·∫•n c√¥ng</div>
                    </div>

                    <div class="guide-image-container">
                        <img src="images/hinh29.jpg">
                        <div class="image-caption">H√¨nh 4.9 ‚Äì H√†ng lo·∫°t y√™u c·∫ßu DISCOVER</div>
                    </div>
                </div>

                <h3>3. Quan s√°t b·∫±ng Wireshark</h3>

                <div class="guide-image-container">
                    <img src="images/hinh30.jpg">
                    <div class="image-caption">H√¨nh 4.10 ‚Äì H√†ng ng√†n g√≥i DHCP t·ª´ MAC gi·∫£ m·∫°o</div>
                </div>

                <h3>4. DHCP Server b·ªã v√¥ hi·ªáu h√≥a</h3>

                <div class="guide-image-container">
                    <img src="images/hinh31.jpg">
                    <div class="image-caption">H√¨nh 4.11 ‚Äì DHCP Server kh√¥ng th·ªÉ c·∫•p IP</div>
                </div>

                <!-- =============================== -->
                <!-- 3. ROGUE DHCP SERVER -->
                <!-- =============================== -->

                <h2 id="rogue">II. T·∫•n c√¥ng Rogue DHCP Server</h2>

                <h3>1. D·ª´ng DHCP Starvation</h3>
                <div class="guide-image-container">
                    <img src="images/hinh32.jpg">
                    <div class="image-caption">H√¨nh 4.12 ‚Äì D·ª´ng attack c≈©</div>
                </div>

                <h3>2. T·∫°o DHCP Gi·∫£</h3>
                <div class="guide-image-container">
                    <img src="images/hinh33.jpg">
                    <div class="image-caption">H√¨nh 4.13 ‚Äì ƒêi·ªÅn c·∫•u h√¨nh DHCP Rogue</div>
                </div>

                <p>C√°c th√¥ng s·ªë:</p>
                <ul>
                    <li>Server ID: 192.168.2.101</li>
                    <li>Start IP: 192.168.2.201</li>
                    <li>End IP: 192.168.2.250</li>
                    <li>Router: 192.168.2.101</li>
                    <li>DNS: 192.168.2.101</li>
                </ul>

                <div class="guide-image-container">
                    <img src="images/hinh34.jpg">
                    <div class="image-caption">H√¨nh 4.14 ‚Äì DHCP OFFER / ACK t·ª´ Kali</div>
                </div>

                <h3>3. Ki·ªÉm tra Client Windows</h3>

                <div class="guide-image-container">
                    <img src="images/hinh35.jpg">
                    <div class="image-caption">H√¨nh 4.15 ‚Äì Client nh·∫≠n IP t·ª´ Rogue DHCP</div>
                </div>

                <div class="guide-image-container">
                    <img src="images/hinh36.jpg">
                    <div class="image-caption">H√¨nh 4.16 ‚Äì Client s·ª≠ d·ª•ng Gateway gi·∫£</div>
                </div>

                <!-- =============================== -->
                <!-- 4. QUIZ -->
                <!-- =============================== -->

                <h2 id="quiz">üìù III. Quiz ki·ªÉm tra ki·∫øn th·ª©c</h2>

                <div class="quiz-container" style="background:#1a2332;padding:30px;border-radius:10px;">

                    <div id="completion-message"
                        style="display:none;padding:20px;background:#27ae60;color:white;text-align:center;border-radius:8px;">
                        üéâ B·∫°n ƒë√£ ho√†n th√†nh quiz!
                    </div>

                    <!-- C√ÇU 1 -->
                    <div id="question-1" class="question-block">
                        <h3>1. M·ª•c ti√™u c·ªßa t·∫•n c√¥ng DHCP Starvation l√† g√¨?</h3>
                        <input id="answer-1" class="quiz-input">
                        <button class="quiz-button" onclick="checkAnswer(1)">Check</button>
                        <p id="feedback-1"></p>
                    </div>

                    <!-- C√ÇU 2 -->
                    <div id="question-2" class="question-block" style="display:none;">
                        <h3>2. C√¥ng c·ª• n√†o ƒë∆∞·ª£c d√πng ƒë·ªÉ th·ª±c hi·ªán DHCP Starvation?</h3>
                        <input id="answer-2" class="quiz-input">
                        <button class="quiz-button" onclick="checkAnswer(2)">Check</button>
                        <p id="feedback-2"></p>
                    </div>

                    <!-- C√ÇU 3 -->
                    <div id="question-3" class="question-block" style="display:none;">
                        <h3>3. Rogue DHCP Server cung c·∫•p Gateway n√†o cho n·∫°n nh√¢n?</h3>
                        <input id="answer-3" class="quiz-input">
                        <button class="quiz-button" onclick="checkAnswer(3)">Check</button>
                        <p id="feedback-3"></p>
                    </div>

                    <!-- C√ÇU 4 -->
                    <div id="question-4" class="question-block" style="display:none;">
                        <h3>4. DHCP Starvation g·ª≠i h√†ng lo·∫°t g√≥i DISCOVER v·ªõi lo·∫°i ƒë·ªãa ch·ªâ n√†o?</h3>
                        <input id="answer-4" class="quiz-input">
                        <button class="quiz-button" onclick="checkAnswer(4)">Check</button>
                        <p id="feedback-4"></p>
                    </div>

                    <!-- C√ÇU 5 -->
                    <div id="question-5" class="question-block" style="display:none;">
                        <h3>5. T·∫°i sao DHCP th·∫≠t kh√¥ng th·ªÉ c·∫•p IP sau khi b·ªã Starvation?</h3>
                        <input id="answer-5" class="quiz-input">
                        <button class="quiz-button" onclick="checkAnswer(5)">Check</button>
                        <p id="feedback-5"></p>
                    </div>

                </div>
            </section>
        </main>
    </div>

    <script>
        // 1. C·∫§U H√åNH ƒê√ÅP √ÅN (c√≥ th·ªÉ ƒë·ªïi n·ªôi dung cho ph√π h·ª£p lab DHCP)
        const correctAnswers = {
            1: ["..."],
            2: ["..."],
            3: ["..."],
            4: ["..."],
            5: ["..."]
        };
    
        // --- H√ÄM G·ª¨I TI·∫æN ƒê·ªò (NH·∫¨N S·ªê PH·∫¶N TRƒÇM) ---
        async function submitProgress(percent) {
            const username = localStorage.getItem("cyber_current_user");
            
            if (!username) {
                console.log("Ch∆∞a ƒëƒÉng nh·∫≠p, kh√¥ng l∆∞u ƒë∆∞·ª£c.");
                return;
            }
    
            try {
                console.log(`ƒêang g·ª≠i ti·∫øn ƒë·ªô ${percent}% v·ªÅ Server...`);
                
                // üëá CH·ªà ƒê·ªîI labId ·ªû ƒê√ÇY
                const response = await fetch('/api/submit-quiz', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        username: username, 
                        labId: 'dhcp_attack',   // <-- t√™n lab DHCP
                        progress: percent 
                    })
                });
    
                const data = await response.json();
                console.log("Server ƒë√£ l∆∞u:", data);
    
            } catch (error) {
                console.error("L·ªói k·∫øt n·ªëi Server:", error);
            }
        }
    
        // 2. H√ÄM CHU·∫®N H√ìA ƒê√ÅP √ÅN
        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim()
                .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"")
                .replace(/\s{2,}/g," ");
        }
    
        // 3. H√ÄM CHECK ƒê√ÅP √ÅN
        function checkAnswer(questionNumber) {
            const inputId = 'answer-' + questionNumber;
            const feedbackId = 'feedback-' + questionNumber;
            const currentQuestionId = 'question-' + questionNumber;
            
            const userInput = document.getElementById(inputId).value;
            const feedbackElement = document.getElementById(feedbackId);
            const currentQuestionElement = document.getElementById(currentQuestionId);
            
            const normalizedInput = normalizeAnswer(userInput);
            const validAnswers = correctAnswers[questionNumber];
            let isCorrect = false;
    
            for (const valid of validAnswers) {
                if (normalizedInput.includes(normalizeAnswer(valid))) {
                    isCorrect = true;
                    break;
                }
            }
    
            if (isCorrect) {
                feedbackElement.style.color = '#2ecc71';
                feedbackElement.innerHTML = '<i class="fas fa-check"></i> Ch√≠nh x√°c!';
                
                document.getElementById(inputId).disabled = true;
                currentQuestionElement.querySelector('.quiz-button').disabled = true;
    
                const currentPercent = questionNumber * 20;
                submitProgress(currentPercent); 
    
                setTimeout(() => {
                    currentQuestionElement.style.display = 'none';
    
                    if (questionNumber < 5) {
                        const nextQuestionId = 'question-' + (questionNumber + 1);
                        const nextQuestionElement = document.getElementById(nextQuestionId);
                        if (nextQuestionElement) {
                            nextQuestionElement.style.display = 'block';
                            document.getElementById('feedback-' + (questionNumber + 1)).innerHTML = '';
                        }
                    } else {
                        document.getElementById('completion-message').style.display = 'block';
                        document.getElementById('quiz').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, 500);
    
            } else {
                feedbackElement.style.color = '#e74c3c';
                feedbackElement.innerHTML = '<i class="fas fa-times"></i> Ch∆∞a ch√≠nh x√°c. Vui l√≤ng th·ª≠ l·∫°i!';
            }
        }
    
        // 4. KH·ªûI T·∫†O
        document.addEventListener('DOMContentLoaded', () => {
            const allQuestions = document.querySelectorAll('.question-block');
            allQuestions.forEach(q => { q.style.display = 'none'; });
            const firstQuestion = document.getElementById('question-1');
            if (firstQuestion) { firstQuestion.style.display = 'block'; }
        });
    </script>
    

</body>
</html>
